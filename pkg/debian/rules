#!/usr/bin/make -f
# -*- makefile -*-

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# This has to be exported to make some magic below work.
export DH_OPTIONS

%:
	dh $@

override_dh_auto_build:
	# Binary is pre-built, no compilation needed

override_dh_auto_install:
	# Install binary
	mkdir -p debian/gocat/usr/local/bin
	cp gocat debian/gocat/usr/local/bin/
	chmod 755 debian/gocat/usr/local/bin/gocat
	
	# Install documentation
	mkdir -p debian/gocat/usr/share/doc/gocat
	cp README.md debian/gocat/usr/share/doc/gocat/ || echo "README.md not found, skipping"
	
	# Install man page
	mkdir -p debian/gocat/usr/share/man/man1
	echo '.TH GOCAT 1 "January 2024" "GoCat 1.0.0" "User Commands"' > debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH NAME' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'gocat \- modern netcat alternative written in Go' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH SYNOPSIS' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B gocat' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '[\fIGLOBAL OPTIONS\fR] \fICOMMAND\fR [\fICOMMAND OPTIONS\fR] [\fIARGUMENTS\fR...]' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH DESCRIPTION' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'GoCat is a modern, feature-rich alternative to netcat written in Go. It provides enhanced functionality for network communication, debugging, and penetration testing with improved IPv6 support, interactive modes, and cross-platform compatibility.' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH COMMANDS' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B connect, c' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Connect to a remote host' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B listen, l' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Start a listener for incoming connections' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B scan, s' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Scan ports on target hosts' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH OPTIONS' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '\fB\-h, \-\-help\fR' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Show help message' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '\fB\-v, \-\-version\fR' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Show version information' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH EXAMPLES' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Listen on port 8080:' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B gocat listen 8080' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Connect to example.com on port 80:' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B gocat connect example.com 80' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.TP' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Scan ports 1-1000 on localhost:' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.B gocat scan localhost 1-1000' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH FEATURES' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'TCP/UDP support with IPv4/IPv6' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Interactive and local interactive modes' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Port scanning capabilities' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'SSL/TLS support' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Proxy support (SOCKS5, HTTP)' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Command execution' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Signal handling and graceful shutdown' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Cross-platform compatibility' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Colored logging output' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.IP \(bu 2' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Command history in interactive mode' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH AUTHOR' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Written by Ibrahim SQL.' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH REPORTING BUGS' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Report bugs to: https://github.com/ibrahmsql/gocat/issues' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH COPYRIGHT' >> debian/gocat/usr/share/man/man1/gocat.1
	echo 'Copyright \(co 2024 Ibrahim SQL. License MIT.' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.SH SEE ALSO' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.BR nc (1),' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.BR netcat (1),' >> debian/gocat/usr/share/man/man1/gocat.1
	echo '.BR nmap (1)' >> debian/gocat/usr/share/man/man1/gocat.1
	gzip -9 debian/gocat/usr/share/man/man1/gocat.1

override_dh_auto_clean:
	# Clean up any build artifacts

override_dh_auto_test:
	# Skip tests for binary package

.PHONY: build clean binary-indep binary-arch binary install